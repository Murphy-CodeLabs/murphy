{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "token-combobox",
  "type": "registry:block",
  "title": "Token Combobox",
  "description": "A searchable combobox of tokens and prices with optional user balances.",
  "dependencies": [
    "@solana/web3.js",
    "@solana/wallet-adapter-react"
  ],
  "registryDependencies": [
    "command",
    "popover",
    "button"
  ],
  "files": [
    {
      "path": "components/ui/murphy/token-combobox.tsx",
      "content": "\"use client\";\nimport React, { useEffect, useState } from \"react\";\nimport { ChevronsUpDownIcon } from \"lucide-react\";\nimport { Button } from \"../button\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\nimport {\n  Command,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n  CommandList,\n} from \"@/components/ui/command\";\nimport { SolAsset } from \"@/types/assets\";\nimport { PublicKey } from \"@solana/web3.js\";\nimport { TokenIcon } from \"./token-icon\";\nimport { fetchWalletAssets } from \"@/lib/assets/birdeye/wallets\";\nimport { useWallet } from \"@solana/wallet-adapter-react\";\n\ntype TokenComboboxProps = {\n  assets?: SolAsset[];\n  trigger?: React.ReactNode;\n  address?: PublicKey | null;\n  showBalances?: boolean;\n  onSelect?: (token: SolAsset) => void;\n  onSearch?: ({\n    query,\n    owner,\n  }: {\n    query: string;\n    owner?: PublicKey;\n  }) => Promise<SolAsset[]>;\n};\n\nexport function TokenCombobox({\n  assets: initialAssets,\n  trigger,\n  address,\n  showBalances = true,\n  onSelect,\n  onSearch,\n}: TokenComboboxProps) {\n  const { publicKey } = useWallet();\n  const [open, setOpen] = React.useState(false);\n  const [assets, setAssets] = React.useState<SolAsset[]>(initialAssets || []);\n  const [value, setValue] = React.useState(\"\");\n  const [searchValue, setSearchValue] = React.useState(\"\");\n  const [isLoading, setLoading] = useState(false);\n  const selectedAsset = React.useMemo(\n    () => assets.find((asset) => asset.mint.toBase58().toLowerCase() === value),\n    [assets, value],\n  );\n\n  const fetchData = async () => {\n    if (!publicKey) return;\n    try {\n      setLoading(true);\n\n      const fetchedAssets = await fetchWalletAssets({\n        owner: publicKey,\n      });\n      setAssets(fetchedAssets);\n    } finally {\n      setLoading(false);\n    }\n  }\n  // In case assets array not provided -> fetch from user wallet\n  useEffect(() => {\n    if (assets.length == 0) {\n      fetchData()\n    }\n  }, []);\n  return (\n    <Popover>\n      <PopoverTrigger asChild>\n        {trigger || (\n          <Button\n            variant=\"outline\"\n            role=\"combobox\"\n            size=\"lg\"\n            aria-expanded={open}\n            className=\"h-12 w-[300px] justify-start gap-2.5 px-3 font-medium\"\n          >\n            {selectedAsset ? (\n              <>\n                <TokenIcon asset={selectedAsset} />\n                {selectedAsset.symbol}\n              </>\n            ) : (\n              \"Select token...\"\n            )}\n            <ChevronsUpDownIcon size={16} className=\"ml-auto opacity-50\" />\n          </Button>\n        )}\n      </PopoverTrigger>\n      <PopoverContent className=\"w-[300px] p-0\">\n        <Command shouldFilter={false}>\n          <CommandInput\n            placeholder=\"Search tokens...\"\n            onValueChange={setSearchValue}\n          />\n          <CommandList>\n            {assets.length === 0 && (\n              <CommandEmpty>\n                {searchValue ? \"No tokens found.\" : \"Loading...\"}\n              </CommandEmpty>\n            )}\n            <CommandGroup>\n              {assets.map((asset) => (\n                <CommandItem\n                  key={asset.mint.toBase58()}\n                  value={asset.mint.toBase58().toLowerCase()}\n                  onSelect={(currentValue) => {\n                    setValue(currentValue === value ? \"\" : currentValue);\n                    setOpen(false);\n                    if (onSelect) onSelect(asset);\n                  }}\n                  className=\"flex items-center gap-2\"\n                >\n                  <TokenIcon asset={asset} />\n                  {asset.symbol}\n                </CommandItem>\n              ))}\n            </CommandGroup>\n          </CommandList>\n        </Command>\n      </PopoverContent>\n    </Popover>\n  );\n}\n",
      "type": "registry:component",
      "target": "components/ui/murphy/token-combobox.tsx"
    },
    {
      "path": "lib/assets/birdeye/wallets.ts",
      "content": "import { PublicKey } from \"@solana/web3.js\";\nimport { SolAsset, FetchWalletArgs } from \"@/types/assets\";\n\n/* fetch all token addresses of a wallet using bird eye */\nconst fetchWalletAssets = async ({\n  owner,\n  limit = 20,\n}: FetchWalletArgs): Promise<SolAsset[]> => {\n  const headers = {\n    \"x-api-key\": process.env.NEXT_PUBLIC_BIRDEYE_API_KEY!,\n    accept: \"application/json\",\n    \"x-chain\": \"solana\",\n  };\n\n  try {\n    const response = await fetch(\n      `https://public-api.birdeye.so/v1/wallet/token_list?wallet=${owner.toString()}`,\n      { headers },\n    );\n\n    const { success, data } = await response.json();\n\n    if (!success || !data?.items) {\n      return [];\n    }\n\n    const items = data.items\n      .filter((item: { symbol: string }) => item.symbol)\n      .map(\n        (item: {\n          address: string;\n          name: string;\n          symbol: string;\n          icon: string;\n          logoURI: string;\n          priceUsd: number;\n          decimals: number;\n          uiAmount: number;\n        }) => ({\n          mint: new PublicKey(item.address),\n          name: item.name,\n          symbol: item.symbol,\n          image: item.icon || item.logoURI,\n          price: item.priceUsd,\n          decimals: item.decimals,\n          userTokenAccount: {\n            address: owner,\n            amount: item.uiAmount,\n          },\n        }),\n      );\n\n    return items\n      .sort((a: SolAsset, b: SolAsset) => {\n        const aValue = (a.userTokenAccount?.amount || 0) * (a.price || 0);\n        const bValue = (b.userTokenAccount?.amount || 0) * (b.price || 0);\n        return bValue - aValue;\n      })\n      .slice(0, limit);\n  } catch (error) {\n    console.error(\"Error fetching wallet assets:\", error);\n    return [];\n  }\n};\n\nexport { fetchWalletAssets };\n",
      "type": "registry:file",
      "target": "lib/assets/birdeye/wallets.ts"
    },
    {
      "path": "types/assets/index.ts",
      "content": "import { PublicKey,Connection } from \"@solana/web3.js\";\n\nexport type SolAsset = {\n  mint: PublicKey;\n  name: string;\n  symbol: string;\n  image: string;\n  decimals: number;\n  price: number;\n  userTokenAccount?: {\n    address: PublicKey;\n    amount: number;\n  };\n};\n\nexport type FetchWalletArgs = {\n  owner: PublicKey;\n  limit?: number;\n};",
      "type": "registry:file",
      "target": "types/assets/index.ts"
    },
    {
      "path": "types/swap/index.ts",
      "content": "import { PublicKey, Connection } from \"@solana/web3.js\";\n\nexport interface Config {\n    JUPITER_REFERRAL_ACCOUNT?: string;\n    JUPITER_FEE_BPS?: number;\n}\n  \ndeclare const _default: {\n    Config: Config;\n};\n\n\nexport default _default; ",
      "type": "registry:file",
      "target": "types/swap/index.ts"
    },
    {
      "path": "public/crypto-logos/solana-logo.svg",
      "content": "<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<!-- Generator: Adobe Illustrator 24.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->\n<svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\"\n\t viewBox=\"0 0 397.7 311.7\" style=\"enable-background:new 0 0 397.7 311.7;\" xml:space=\"preserve\">\n<style type=\"text/css\">\n\t.st0{fill:url(#SVGID_1_);}\n\t.st1{fill:url(#SVGID_2_);}\n\t.st2{fill:url(#SVGID_3_);}\n</style>\n<linearGradient id=\"SVGID_1_\" gradientUnits=\"userSpaceOnUse\" x1=\"360.8791\" y1=\"351.4553\" x2=\"141.213\" y2=\"-69.2936\" gradientTransform=\"matrix(1 0 0 -1 0 314)\">\n\t<stop  offset=\"0\" style=\"stop-color:#00FFA3\"/>\n\t<stop  offset=\"1\" style=\"stop-color:#DC1FFF\"/>\n</linearGradient>\n<path class=\"st0\" d=\"M64.6,237.9c2.4-2.4,5.7-3.8,9.2-3.8h317.4c5.8,0,8.7,7,4.6,11.1l-62.7,62.7c-2.4,2.4-5.7,3.8-9.2,3.8H6.5\n\tc-5.8,0-8.7-7-4.6-11.1L64.6,237.9z\"/>\n<linearGradient id=\"SVGID_2_\" gradientUnits=\"userSpaceOnUse\" x1=\"264.8291\" y1=\"401.6014\" x2=\"45.163\" y2=\"-19.1475\" gradientTransform=\"matrix(1 0 0 -1 0 314)\">\n\t<stop  offset=\"0\" style=\"stop-color:#00FFA3\"/>\n\t<stop  offset=\"1\" style=\"stop-color:#DC1FFF\"/>\n</linearGradient>\n<path class=\"st1\" d=\"M64.6,3.8C67.1,1.4,70.4,0,73.8,0h317.4c5.8,0,8.7,7,4.6,11.1l-62.7,62.7c-2.4,2.4-5.7,3.8-9.2,3.8H6.5\n\tc-5.8,0-8.7-7-4.6-11.1L64.6,3.8z\"/>\n<linearGradient id=\"SVGID_3_\" gradientUnits=\"userSpaceOnUse\" x1=\"312.5484\" y1=\"376.688\" x2=\"92.8822\" y2=\"-44.061\" gradientTransform=\"matrix(1 0 0 -1 0 314)\">\n\t<stop  offset=\"0\" style=\"stop-color:#00FFA3\"/>\n\t<stop  offset=\"1\" style=\"stop-color:#DC1FFF\"/>\n</linearGradient>\n<path class=\"st2\" d=\"M333.1,120.1c-2.4-2.4-5.7-3.8-9.2-3.8H6.5c-5.8,0-8.7,7-4.6,11.1l62.7,62.7c2.4,2.4,5.7,3.8,9.2,3.8h317.4\n\tc5.8,0,8.7-7,4.6-11.1L333.1,120.1z\"/>\n</svg>\n",
      "type": "registry:file",
      "target": "public/crypto-logos/solana-logo.svg"
    },
    {
      "path": "public/crypto-logos/usd-coin-usdc-logo.svg",
      "content": "<svg data-name=\"86977684-12db-4850-8f30-233a7c267d11\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 2000 2000\">\n  <path d=\"M1000 2000c554.17 0 1000-445.83 1000-1000S1554.17 0 1000 0 0 445.83 0 1000s445.83 1000 1000 1000z\" fill=\"#2775ca\"/>\n  <path d=\"M1275 1158.33c0-145.83-87.5-195.83-262.5-216.66-125-16.67-150-50-150-108.34s41.67-95.83 125-95.83c75 0 116.67 25 137.5 87.5 4.17 12.5 16.67 20.83 29.17 20.83h66.66c16.67 0 29.17-12.5 29.17-29.16v-4.17c-16.67-91.67-91.67-162.5-187.5-170.83v-100c0-16.67-12.5-29.17-33.33-33.34h-62.5c-16.67 0-29.17 12.5-33.34 33.34v95.83c-125 16.67-204.16 100-204.16 204.17 0 137.5 83.33 191.66 258.33 212.5 116.67 20.83 154.17 45.83 154.17 112.5s-58.34 112.5-137.5 112.5c-108.34 0-145.84-45.84-158.34-108.34-4.16-16.66-16.66-25-29.16-25h-70.84c-16.66 0-29.16 12.5-29.16 29.17v4.17c16.66 104.16 83.33 179.16 220.83 200v100c0 16.66 12.5 29.16 33.33 33.33h62.5c16.67 0 29.17-12.5 33.34-33.33v-100c125-20.84 208.33-108.34 208.33-220.84z\" fill=\"#fff\"/>\n  <path d=\"M787.5 1595.83c-325-116.66-491.67-479.16-370.83-800 62.5-175 200-308.33 370.83-370.83 16.67-8.33 25-20.83 25-41.67V325c0-16.67-8.33-29.17-25-33.33-4.17 0-12.5 0-16.67 4.16-395.83 125-612.5 545.84-487.5 941.67 75 233.33 254.17 412.5 487.5 487.5 16.67 8.33 33.34 0 37.5-16.67 4.17-4.16 4.17-8.33 4.17-16.66v-58.34c0-12.5-12.5-29.16-25-37.5zM1229.17 295.83c-16.67-8.33-33.34 0-37.5 16.67-4.17 4.17-4.17 8.33-4.17 16.67v58.33c0 16.67 12.5 33.33 25 41.67 325 116.66 491.67 479.16 370.83 800-62.5 175-200 308.33-370.83 370.83-16.67 8.33-25 20.83-25 41.67V1700c0 16.67 8.33 29.17 25 33.33 4.17 0 12.5 0 16.67-4.16 395.83-125 612.5-545.84 487.5-941.67-75-237.5-258.34-416.67-487.5-491.67z\" fill=\"#fff\"/>\n</svg>\n",
      "type": "registry:file",
      "target": "public/crypto-logos/usd-coin-usdc-logo.svg"
    },
    {
      "path": "public/crypto-logos/tether-usdt-logo.svg",
      "content": "<svg id=\"Layer_1\" data-name=\"Layer 1\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 339.43 295.27\"><title>tether-usdt-logo</title><path d=\"M62.15,1.45l-61.89,130a2.52,2.52,0,0,0,.54,2.94L167.95,294.56a2.55,2.55,0,0,0,3.53,0L338.63,134.4a2.52,2.52,0,0,0,.54-2.94l-61.89-130A2.5,2.5,0,0,0,275,0H64.45a2.5,2.5,0,0,0-2.3,1.45h0Z\" style=\"fill:#50af95;fill-rule:evenodd\"/><path d=\"M191.19,144.8v0c-1.2.09-7.4,0.46-21.23,0.46-11,0-18.81-.33-21.55-0.46v0c-42.51-1.87-74.24-9.27-74.24-18.13s31.73-16.25,74.24-18.15v28.91c2.78,0.2,10.74.67,21.74,0.67,13.2,0,19.81-.55,21-0.66v-28.9c42.42,1.89,74.08,9.29,74.08,18.13s-31.65,16.24-74.08,18.12h0Zm0-39.25V79.68h59.2V40.23H89.21V79.68H148.4v25.86c-48.11,2.21-84.29,11.74-84.29,23.16s36.18,20.94,84.29,23.16v82.9h42.78V151.83c48-2.21,84.12-11.73,84.12-23.14s-36.09-20.93-84.12-23.15h0Zm0,0h0Z\" style=\"fill:#fff;fill-rule:evenodd\"/></svg>",
      "type": "registry:file",
      "target": "public/crypto-logos/tether-usdt-logo.svg"
    }
  ]
}