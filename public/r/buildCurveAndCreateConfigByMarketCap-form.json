{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "buildCurveAndCreateConfigByMarketCap-form",
  "type": "registry:block",
  "title": "Build Curve and Create Config by Market Cap Form",
  "description": "A simple build curve and create config by market cap form component.",
  "dependencies": [
    "@solana/web3.js",
    "@solana/spl-token",
    "@solana/wallet-adapter-react",
    "meteora-dbc"
  ],
  "registryDependencies": [
    "input",
    "button",
    "form",
    "card",
    "sonner",
    "select",
    "dialog",
    "dropdown-menu"
  ],
  "files": [
    {
      "path": "components/ui/murphy/buildCurveAndCreateConfigByMarketCap-form.tsx",
      "content": "\"use client\";\n\nimport { useState, useEffect, useContext } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { toast } from \"sonner\";\nimport { Loader2, ExternalLink, CheckCircle, Settings } from \"lucide-react\";\nimport { PublicKey, Keypair } from \"@solana/web3.js\";\nimport { useConnection, useWallet } from \"@solana/wallet-adapter-react\";\nimport { DynamicBondingCurveClient } from \"@meteora-ag/dynamic-bonding-curve-sdk\";\nimport BN from \"bn.js\";\n\n// UI components\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ConnectWalletButton } from \"./connect-wallet-button\";\nimport {\n  Card,\n  CardContent,\n  CardHeader,\n  CardTitle,\n  CardDescription,\n} from \"@/components/ui/card\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\n\n// Context\nimport { ModalContext } from \"@/components/providers/wallet-provider\";\n\nenum FeeSchedulerMode {\n  Linear = 0,\n}\n\ninterface BuildCurveResult {\n  config: string;\n  signature: string;\n}\n\ntype FormValues = {\n  // Các tham số của buildCurveByMarketCapParam\n  totalTokenSupply: number;\n  initialMarketCap: number;\n  migrationMarketCap: number;\n  migrationOption: number;\n  tokenBaseDecimal: number;\n  tokenQuoteDecimal: number;\n\n  // Tham số của feeSchedulerParam\n  numberOfPeriod: number;\n  reductionFactor: number;\n  periodFrequency: number;\n  feeSchedulerMode: number;\n\n  // Các thông số khác\n  baseFeeBps: number;\n  dynamicFeeEnabled: boolean;\n  activationType: number;\n  collectFeeMode: number;\n  migrationFeeOption: number;\n  tokenType: number;\n\n  // Phân phối LP\n  partnerLpPercentage: number;\n  creatorLpPercentage: number;\n  partnerLockedLpPercentage: number;\n  creatorLockedLpPercentage: number;\n\n  // Địa chỉ\n  feeClaimer: string;\n  leftoverReceiver: string;\n  quoteMint: string;\n};\n\n// Create custom resolver for form\nconst customResolver = (data: any) => {\n  const errors: any = {};\n\n  // Validate totalTokenSupply\n  if (!data.totalTokenSupply) {\n    errors.totalTokenSupply = {\n      type: \"required\",\n      message: \"Total token supply is required\",\n    };\n  } else if (data.totalTokenSupply <= 0) {\n    errors.totalTokenSupply = {\n      type: \"min\",\n      message: \"Total token supply must be greater than 0\",\n    };\n  }\n\n  // Validate initialMarketCap\n  if (!data.initialMarketCap) {\n    errors.initialMarketCap = {\n      type: \"required\",\n      message: \"Initial market cap is required\",\n    };\n  } else if (data.initialMarketCap <= 0) {\n    errors.initialMarketCap = {\n      type: \"min\",\n      message: \"Initial market cap must be greater than 0\",\n    };\n  }\n\n  // Validate migrationMarketCap\n  if (!data.migrationMarketCap) {\n    errors.migrationMarketCap = {\n      type: \"required\",\n      message: \"Migration market cap is required\",\n    };\n  } else if (data.migrationMarketCap <= 0) {\n    errors.migrationMarketCap = {\n      type: \"min\",\n      message: \"Migration market cap must be greater than 0\",\n    };\n  }\n\n  // Validate tokenBaseDecimal\n  if (data.tokenBaseDecimal === undefined || data.tokenBaseDecimal === null) {\n    errors.tokenBaseDecimal = {\n      type: \"required\",\n      message: \"Token base decimal is required\",\n    };\n  } else if (data.tokenBaseDecimal < 0 || data.tokenBaseDecimal > 18) {\n    errors.tokenBaseDecimal = {\n      type: \"range\",\n      message: \"Token base decimal must be between 0 and 18\",\n    };\n  }\n\n  // Validate tokenQuoteDecimal\n  if (data.tokenQuoteDecimal === undefined || data.tokenQuoteDecimal === null) {\n    errors.tokenQuoteDecimal = {\n      type: \"required\",\n      message: \"Token quote decimal is required\",\n    };\n  } else if (data.tokenQuoteDecimal < 0 || data.tokenQuoteDecimal > 18) {\n    errors.tokenQuoteDecimal = {\n      type: \"range\",\n      message: \"Token quote decimal must be between 0 and 18\",\n    };\n  }\n\n  // Validate address fields\n  const validateAddress = (field: string, name: string) => {\n    if (!data[field]) {\n      errors[field] = {\n        type: \"required\",\n        message: `${name} is required`,\n      };\n    } else {\n      try {\n        new PublicKey(data[field]);\n      } catch (e) {\n        errors[field] = {\n          type: \"invalid\",\n          message: \"Invalid Solana address\",\n        };\n      }\n    }\n  };\n\n  validateAddress(\"feeClaimer\", \"Fee claimer address\");\n  validateAddress(\"leftoverReceiver\", \"Leftover receiver address\");\n  validateAddress(\"quoteMint\", \"Quote mint address\");\n\n  // Validate LP percentages\n  const validatePercentage = (field: string, name: string) => {\n    if (\n      data[field] === undefined ||\n      data[field] === null ||\n      data[field] === \"\"\n    ) {\n      errors[field] = {\n        type: \"required\",\n        message: `${name} is required`,\n      };\n    } else if (Number(data[field]) < 0 || Number(data[field]) > 100) {\n      errors[field] = {\n        type: \"range\",\n        message: `${name} must be between 0 and 100%`,\n      };\n    }\n  };\n\n  validatePercentage(\"partnerLpPercentage\", \"Partner LP percentage\");\n  validatePercentage(\"creatorLpPercentage\", \"Creator LP percentage\");\n  validatePercentage(\n    \"partnerLockedLpPercentage\",\n    \"Partner locked LP percentage\"\n  );\n  validatePercentage(\n    \"creatorLockedLpPercentage\",\n    \"Creator locked LP percentage\"\n  );\n\n  // Validate that percentages sum to 100\n  const totalPercentage =\n    Number(data.partnerLpPercentage || 0) +\n    Number(data.creatorLpPercentage || 0) +\n    Number(data.partnerLockedLpPercentage || 0) +\n    Number(data.creatorLockedLpPercentage || 0);\n\n  if (totalPercentage !== 100) {\n    errors.partnerLpPercentage = {\n      type: \"validate\",\n      message: \"Total LP percentage must be 100%\",\n    };\n  }\n\n  return {\n    values: Object.keys(errors).length === 0 ? data : {},\n    errors,\n  };\n};\n\nexport default function BuildCurveAndCreateConfigByMarketCapForm({\n  onConfigCreated,\n}: {\n  onConfigCreated?: (configAddress: string) => void;\n}) {\n  const { connection } = useConnection();\n  const { publicKey, connected, wallet } = useWallet();\n  const { switchToNextEndpoint, endpoint } = useContext(ModalContext);\n\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [result, setResult] = useState<BuildCurveResult | null>(null);\n  const [currentStage, setCurrentStage] = useState<\n    \"input\" | \"confirming\" | \"success\" | \"error\"\n  >(\"input\");\n  const [error, setError] = useState(\"\");\n  const [mounted, setMounted] = useState(false);\n  const [network, setNetwork] = useState(\"devnet\");\n\n  // Form setup with react-hook-form\n  const form = useForm<FormValues>({\n    defaultValues: {\n      totalTokenSupply: 1000000000,\n      initialMarketCap: 98,\n      migrationMarketCap: 3200,\n      migrationOption: 0,\n      tokenBaseDecimal: 9,\n      tokenQuoteDecimal: 9,\n\n      numberOfPeriod: 0,\n      reductionFactor: 0,\n      periodFrequency: 0,\n      feeSchedulerMode: FeeSchedulerMode.Linear,\n\n      baseFeeBps: 2500000,\n      dynamicFeeEnabled: false,\n      activationType: 0,\n      collectFeeMode: 0,\n      migrationFeeOption: 0,\n      tokenType: 0,\n\n      partnerLpPercentage: 25,\n      creatorLpPercentage: 25,\n      partnerLockedLpPercentage: 25,\n      creatorLockedLpPercentage: 25,\n\n      feeClaimer: \"\",\n      leftoverReceiver: \"\",\n      quoteMint: \"So11111111111111111111111111111111111111112\", // SOL by default\n    },\n    mode: \"onSubmit\",\n    resolver: customResolver,\n  });\n\n  // Chỉ render sau khi component được mount trên client\n  useEffect(() => {\n    setMounted(true);\n  }, []);\n\n  // Cập nhật trạng thái network khi endpoint thay đổi\n  useEffect(() => {\n    if (endpoint) {\n      setNetwork(endpoint.includes(\"devnet\") ? \"devnet\" : \"mainnet\");\n    }\n  }, [endpoint]);\n\n  // Tự động điền địa chỉ ví khi ví kết nối\n  useEffect(() => {\n    if (connected && publicKey) {\n      form.setValue(\"feeClaimer\", publicKey.toString());\n      form.setValue(\"leftoverReceiver\", publicKey.toString());\n    }\n  }, [connected, publicKey, form]);\n\n  // Xử lý khi form được gửi đi\n  const onSubmit = async (values: FormValues) => {\n    if (!connected || !publicKey || !wallet) {\n      toast.error(\"Please connect your wallet\");\n      return;\n    }\n\n    try {\n      setIsSubmitting(true);\n      setCurrentStage(\"confirming\");\n      setError(\"\");\n\n      toast.loading(\"Creating configuration...\", {\n        id: \"build-curve-market-cap\",\n      });\n\n      try {\n        // Khởi tạo DBC client\n        const client = new DynamicBondingCurveClient(connection);\n\n        // Tạo keypair mới cho config\n        const configKeypair = Keypair.generate();\n\n        // Tạo các tham số cho hàm buildCurveAndCreateConfigByMarketCap\n        const params = {\n          buildCurveByMarketCapParam: {\n            totalTokenSupply: values.totalTokenSupply,\n            initialMarketCap: values.initialMarketCap,\n            migrationMarketCap: values.migrationMarketCap,\n            migrationOption: values.migrationOption,\n            tokenBaseDecimal: values.tokenBaseDecimal,\n            tokenQuoteDecimal: values.tokenQuoteDecimal,\n            feeSchedulerParam: {\n              numberOfPeriod: values.numberOfPeriod,\n              reductionFactor: values.reductionFactor,\n              periodFrequency: values.periodFrequency,\n              feeSchedulerMode: values.feeSchedulerMode,\n            },\n            baseFeeBps: values.baseFeeBps,\n            dynamicFeeEnabled: values.dynamicFeeEnabled,\n            activationType: values.activationType,\n            collectFeeMode: values.collectFeeMode,\n            migrationFeeOption: values.migrationFeeOption,\n            tokenType: values.tokenType,\n            lockedVesting: {\n              amountPerPeriod: new BN(\"0\"),\n              cliffDurationFromMigrationTime: new BN(\"0\"),\n              frequency: new BN(\"0\"),\n              numberOfPeriod: new BN(\"0\"),\n              cliffUnlockAmount: new BN(\"0\"),\n            },\n            partnerLpPercentage: values.partnerLpPercentage,\n            creatorLpPercentage: values.creatorLpPercentage,\n            partnerLockedLpPercentage: values.partnerLockedLpPercentage,\n            creatorLockedLpPercentage: values.creatorLockedLpPercentage,\n          },\n          feeClaimer: new PublicKey(values.feeClaimer),\n          leftoverReceiver: new PublicKey(values.leftoverReceiver),\n          payer: publicKey,\n          quoteMint: new PublicKey(values.quoteMint),\n          config: configKeypair.publicKey,\n        };\n\n        // Tạo transaction\n        const transaction =\n          await client.partners.buildCurveAndCreateConfigByMarketCap(params);\n\n        // Lấy blockhash gần nhất\n        const { blockhash, lastValidBlockHeight } =\n          await connection.getLatestBlockhash();\n        transaction.recentBlockhash = blockhash;\n        transaction.lastValidBlockHeight = lastValidBlockHeight;\n\n        // Đặt feePayer cho transaction\n        transaction.feePayer = publicKey;\n\n        // Ký giao dịch với configKeypair\n        transaction.partialSign(configKeypair);\n\n        // Gửi và ký giao dịch\n        const signature = await wallet.adapter.sendTransaction(\n          transaction,\n          connection\n        );\n\n        // Đợi xác nhận\n        await connection.confirmTransaction({\n          blockhash,\n          lastValidBlockHeight,\n          signature,\n        });\n\n        // Lưu kết quả\n        const configAddress = configKeypair.publicKey.toString();\n        setResult({\n          config: configAddress,\n          signature: signature,\n        });\n\n        // Gọi callback nếu được cung cấp\n        if (onConfigCreated) {\n          onConfigCreated(configAddress);\n        }\n\n        setCurrentStage(\"success\");\n\n        toast.success(\"Configuration created successfully!\", {\n          id: \"build-curve-market-cap\",\n          description: `Config: ${configAddress.slice(\n            0,\n            8\n          )}...${configAddress.slice(-8)}`,\n        });\n      } catch (transactionError: any) {\n        console.error(\"Transaction error: \", transactionError);\n        throw transactionError;\n      }\n    } catch (err: any) {\n      console.error(\"Error creating configuration:\", err);\n\n      setCurrentStage(\"error\");\n      setError(err.message || \"An unknown error occurred\");\n\n      // Kiểm tra nếu người dùng hủy/từ chối giao dịch\n      if (\n        err.message &&\n        (err.message.includes(\"rejected\") || err.message.includes(\"canceled\"))\n      ) {\n        toast.error(\"Transaction rejected\", {\n          id: \"build-curve-market-cap\",\n          description: \"You have rejected the transaction\",\n        });\n      } else {\n        toast.error(\"Cannot create configuration\", {\n          id: \"build-curve-market-cap\",\n          description: err.message,\n        });\n\n        // Nếu giao dịch thất bại do lỗi kết nối, thử chuyển sang RPC endpoint khác\n        if (\n          err.message?.includes(\"failed to fetch\") ||\n          err.message?.includes(\"timeout\") ||\n          err.message?.includes(\"429\") ||\n          err.message?.includes(\"503\")\n        ) {\n          switchToNextEndpoint();\n        }\n      }\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  // Chức năng mở explorer để xem giao dịch\n  const viewExplorer = () => {\n    if (result?.signature) {\n      const baseUrl =\n        network === \"devnet\"\n          ? \"https://explorer.solana.com/tx/\"\n          : \"https://solscan.io/tx/\";\n      window.open(\n        `${baseUrl}${result.signature}${\n          network === \"devnet\" ? \"?cluster=devnet\" : \"\"\n        }`,\n        \"_blank\"\n      );\n    }\n  };\n\n  // Chức năng mở explorer để xem cấu hình\n  const viewConfig = () => {\n    if (result?.config) {\n      const baseUrl =\n        network === \"devnet\"\n          ? \"https://explorer.solana.com/address/\"\n          : \"https://solscan.io/account/\";\n      window.open(\n        `${baseUrl}${result.config}${\n          network === \"devnet\" ? \"?cluster=devnet\" : \"\"\n        }`,\n        \"_blank\"\n      );\n    }\n  };\n\n  // Reset form\n  const resetForm = () => {\n    form.reset();\n    setResult(null);\n    setCurrentStage(\"input\");\n    setError(\"\");\n  };\n\n  // Render form view\n  const renderForm = () => (\n    <Form {...form}>\n      <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n        <div className=\"bg-secondary/50 rounded-lg p-4\">\n          <h3 className=\"font-medium mb-4\">Market parameters</h3>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <FormField\n              control={form.control}\n              name=\"totalTokenSupply\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Total token supply</FormLabel>\n                  <FormControl>\n                    <Input\n                      type=\"number\"\n                      placeholder=\"1000000000\"\n                      {...field}\n                      disabled={isSubmitting}\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"initialMarketCap\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Initial market cap</FormLabel>\n                  <FormControl>\n                    <Input\n                      type=\"number\"\n                      placeholder=\"98\"\n                      {...field}\n                      disabled={isSubmitting}\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"migrationMarketCap\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Migration market cap</FormLabel>\n                  <FormControl>\n                    <Input\n                      type=\"number\"\n                      placeholder=\"3200\"\n                      {...field}\n                      disabled={isSubmitting}\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"migrationOption\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Migration option</FormLabel>\n                  <FormControl>\n                    <Input\n                      type=\"number\"\n                      placeholder=\"0\"\n                      {...field}\n                      disabled={isSubmitting}\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"tokenBaseDecimal\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Token base decimal</FormLabel>\n                  <FormControl>\n                    <Input\n                      type=\"number\"\n                      placeholder=\"9\"\n                      {...field}\n                      disabled={isSubmitting}\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"tokenQuoteDecimal\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Token quote decimal</FormLabel>\n                  <FormControl>\n                    <Input\n                      type=\"number\"\n                      placeholder=\"9\"\n                      {...field}\n                      disabled={isSubmitting}\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n          </div>\n        </div>\n\n        <div className=\"bg-secondary/50 rounded-lg p-4\">\n          <h3 className=\"font-medium mb-4\">Fee parameters</h3>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <FormField\n              control={form.control}\n              name=\"baseFeeBps\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Base fee (BPS)</FormLabel>\n                  <FormControl>\n                    <Input\n                      type=\"number\"\n                      placeholder=\"2500000\"\n                      {...field}\n                      disabled={isSubmitting}\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"dynamicFeeEnabled\"\n              render={({ field }) => (\n                <FormItem className=\"flex flex-row items-start space-x-3 space-y-0 rounded-md p-4\">\n                  <FormControl>\n                    <input\n                      type=\"checkbox\"\n                      className=\"h-4 w-4 mt-1\"\n                      checked={field.value}\n                      onChange={field.onChange}\n                      disabled={isSubmitting}\n                    />\n                  </FormControl>\n                  <div className=\"space-y-1 leading-none\">\n                    <FormLabel>Enable dynamic fee</FormLabel>\n                  </div>\n                </FormItem>\n              )}\n            />\n          </div>\n        </div>\n\n        <div className=\"bg-secondary/50 rounded-lg p-4 space-y-4\">\n          <div className=\"font-medium\">LP distribution</div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <FormField\n              control={form.control}\n              name=\"partnerLpPercentage\"\n              render={({ field }) => (\n                <FormItem>\n                  <div className=\"flex justify-between items-center\">\n                    <FormLabel>Partner LP %</FormLabel>\n                  </div>\n                  <FormControl>\n                    <Input\n                      type=\"number\"\n                      placeholder=\"25\"\n                      min=\"0\"\n                      max=\"100\"\n                      {...field}\n                      disabled={isSubmitting}\n                      className=\"bg-transparent text-sm h-8\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"creatorLpPercentage\"\n              render={({ field }) => (\n                <FormItem>\n                  <div className=\"flex justify-between items-center\">\n                    <FormLabel>Creator LP %</FormLabel>\n                  </div>\n                  <FormControl>\n                    <Input\n                      type=\"number\"\n                      placeholder=\"25\"\n                      min=\"0\"\n                      max=\"100\"\n                      {...field}\n                      disabled={isSubmitting}\n                      className=\"bg-transparent text-sm h-8\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"partnerLockedLpPercentage\"\n              render={({ field }) => (\n                <FormItem>\n                  <div className=\"flex justify-between items-center\">\n                    <FormLabel>Partner locked LP %</FormLabel>\n                  </div>\n                  <FormControl>\n                    <Input\n                      type=\"number\"\n                      placeholder=\"25\"\n                      min=\"0\"\n                      max=\"100\"\n                      {...field}\n                      disabled={isSubmitting}\n                      className=\"bg-transparent text-sm h-8\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"creatorLockedLpPercentage\"\n              render={({ field }) => (\n                <FormItem>\n                  <div className=\"flex justify-between items-center\">\n                    <FormLabel>Creator locked LP %</FormLabel>\n                  </div>\n                  <FormControl>\n                    <Input\n                      type=\"number\"\n                      placeholder=\"25\"\n                      min=\"0\"\n                      max=\"100\"\n                      {...field}\n                      disabled={isSubmitting}\n                      className=\"bg-transparent text-sm h-8\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n          </div>\n\n          <p className=\"text-xs text-muted-foreground\">\n            Total LP percentage must be 100%. These ratios determine how token\n            LP is distributed.\n          </p>\n        </div>\n\n        <div className=\"bg-secondary/50 rounded-lg p-4\">\n          <h3 className=\"font-medium mb-4\">Address</h3>\n          <div className=\"grid grid-cols-1 gap-4\">\n            <FormField\n              control={form.control}\n              name=\"feeClaimer\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Fee claimer address</FormLabel>\n                  <FormControl>\n                    <Input\n                      placeholder=\"Enter fee claimer address\"\n                      {...field}\n                      disabled={isSubmitting}\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"leftoverReceiver\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Leftover receiver address</FormLabel>\n                  <FormControl>\n                    <Input\n                      placeholder=\"Enter leftover receiver address\"\n                      {...field}\n                      disabled={isSubmitting}\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"quoteMint\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Quote mint address</FormLabel>\n                  <FormControl>\n                    <Select\n                      onValueChange={field.onChange}\n                      defaultValue={field.value}\n                      disabled={isSubmitting}\n                    >\n                      <SelectTrigger className=\"w-full\">\n                        <SelectValue placeholder=\"Select quote mint address\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"So11111111111111111111111111111111111111112\">\n                          <div className=\"flex items-center\">\n                            <img\n                              src=\"/crypto-logos/solana-logo.svg\"\n                              alt=\"SOL\"\n                              className=\"w-5 h-5 mr-2 rounded-full\"\n                            />\n                            SOL\n                          </div>\n                        </SelectItem>\n                        <SelectItem value=\"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\">\n                          <div className=\"flex items-center\">\n                            <img\n                              src=\"/crypto-logos/usd-coin-usdc-logo.svg\"\n                              alt=\"USDC\"\n                              className=\"w-5 h-5 mr-2 rounded-full\"\n                            />\n                            USDC\n                          </div>\n                        </SelectItem>\n                        <SelectItem value=\"Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB\">\n                          <div className=\"flex items-center\">\n                            <img\n                              src=\"/crypto-logos/tether-usdt-logo.svg\"\n                              alt=\"USDT\"\n                              className=\"w-5 h-5 mr-2 rounded-full\"\n                            />\n                            USDT\n                          </div>\n                        </SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n          </div>\n        </div>\n\n        <div className=\"space-y-4\">\n          <div className=\"bg-secondary/50 rounded-lg p-4 space-y-2\">\n            <div className=\"flex justify-between items-center text-sm\">\n              <span>Network</span>\n              <Badge variant={network === \"mainnet\" ? \"default\" : \"secondary\"}>\n                {network}\n              </Badge>\n            </div>\n          </div>\n\n          <div className=\"pt-2\">\n            {!connected ? (\n              <ConnectWalletButton className=\"w-full\" />\n            ) : (\n              <Button type=\"submit\" className=\"w-full\" disabled={isSubmitting}>\n                {isSubmitting ? (\n                  <>\n                    <Loader2 className=\"h-4 w-4 animate-spin mr-2\" />\n                    Creating...\n                  </>\n                ) : (\n                  \"Create configuration by market cap\"\n                )}\n              </Button>\n            )}\n          </div>\n        </div>\n      </form>\n    </Form>\n  );\n\n  // Render success view\n  const renderSuccess = () => (\n    <div className=\"space-y-4 p-4\">\n      <div className=\"mx-auto flex h-20 w-20 items-center justify-center rounded-full bg-green-100\">\n        <CheckCircle className=\"h-10 w-10 text-green-600\" />\n      </div>\n      <h3 className=\"text-xl font-bold text-center\">Configuration created!</h3>\n\n      <div className=\"space-y-2\">\n        <div className=\"text-sm text-muted-foreground\">\n          Configuration address:\n        </div>\n        <div className=\"bg-secondary/60 rounded p-2 text-sm font-mono break-all\">\n          {result?.config}\n        </div>\n      </div>\n\n      <div className=\"space-y-2\">\n        <div className=\"text-sm text-muted-foreground\">\n          Transaction signature:\n        </div>\n        <div className=\"bg-secondary/60 rounded p-2 text-sm font-mono break-all\">\n          {result?.signature}\n        </div>\n      </div>\n\n      <div className=\"flex gap-2 mt-4\">\n        <Button variant=\"outline\" onClick={viewConfig} className=\"flex-1\">\n          <ExternalLink className=\"h-4 w-4 mr-2\" />\n          View configuration\n        </Button>\n\n        <Button variant=\"outline\" onClick={viewExplorer} className=\"flex-1\">\n          <ExternalLink className=\"h-4 w-4 mr-2\" />\n          View transaction\n        </Button>\n      </div>\n\n      <Button onClick={resetForm} className=\"w-full\">\n        Create new configuration\n      </Button>\n    </div>\n  );\n\n  // Render error view\n  const renderError = () => (\n    <div className=\"space-y-4 p-4 text-center\">\n      <div className=\"mx-auto flex h-20 w-20 items-center justify-center rounded-full bg-red-100\">\n        <svg\n          className=\"h-10 w-10 text-red-600\"\n          fill=\"none\"\n          stroke=\"currentColor\"\n          viewBox=\"0 0 24 24\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n        >\n          <path\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n            strokeWidth={2}\n            d=\"M6 18L18 6M6 6l12 12\"\n          />\n        </svg>\n      </div>\n      <h3 className=\"text-xl font-bold\">Failed to create configuration</h3>\n      <p className=\"text-muted-foreground\">\n        {error || \"An error occurred during configuration creation.\"}\n      </p>\n      <Button\n        onClick={() => {\n          setCurrentStage(\"input\");\n        }}\n        className=\"w-full\"\n      >\n        Try again\n      </Button>\n    </div>\n  );\n\n  // Render confirmation view\n  const renderConfirming = () => (\n    <div className=\"space-y-4 p-4 text-center\">\n      <div className=\"mx-auto flex h-20 w-20 items-center justify-center\">\n        <Loader2 className=\"h-10 w-10 animate-spin\" />\n      </div>\n      <h3 className=\"text-xl font-bold\">Confirming</h3>\n      <p className=\"text-muted-foreground\">\n        Please wait while your transaction is being processed...\n      </p>\n    </div>\n  );\n\n  // Render dựa trên stage hiện tại\n  const renderStageContent = () => {\n    switch (currentStage) {\n      case \"success\":\n        return renderSuccess();\n      case \"error\":\n        return renderError();\n      case \"confirming\":\n        return renderConfirming();\n      default:\n        return renderForm();\n    }\n  };\n\n  // Tránh lỗi hydration\n  if (!mounted) {\n    return (\n      <Card>\n        <CardHeader>\n          <CardTitle>Create configuration by market cap</CardTitle>\n          <CardDescription>\n            Build a non-decreasing configuration based on market cap\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"flex items-center justify-center p-6\">\n          <div className=\"flex flex-col items-center gap-2\">\n            <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\n            <p className=\"text-sm text-muted-foreground\">Loading...</p>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle className=\"flex items-center justify-between\">\n          <span>Create configuration by market cap</span>\n          {connected && publicKey && (\n            <Badge variant=\"outline\" className=\"ml-2\">\n              {publicKey.toString().slice(0, 4)}...\n              {publicKey.toString().slice(-4)}\n            </Badge>\n          )}\n        </CardTitle>\n        <CardDescription>\n          Build a non-decreasing configuration based on market cap\n        </CardDescription>\n      </CardHeader>\n      <CardContent>{renderStageContent()}</CardContent>\n    </Card>\n  );\n}\n",
      "type": "registry:component",
      "target": "components/ui/murphy/buildCurveAndCreateConfigByMarketCap-form.tsx"
    },
    {
      "path": "hook/murphy/use-walletModal.ts",
      "content": "import { createContext, useContext } from 'react';\n\nexport interface WalletModalContextState {\n    visible: boolean;\n    setVisible: (open: boolean) => void;\n}\n\nconst DEFAULT_CONTEXT = {\n    setVisible(_open: boolean) {\n        console.error(constructMissingProviderErrorMessage('call', 'setVisible'));\n    },\n    visible: false,\n};\nObject.defineProperty(DEFAULT_CONTEXT, 'visible', {\n    get() {\n        console.error(constructMissingProviderErrorMessage('read', 'visible'));\n        return false;\n    },\n});\n\nfunction constructMissingProviderErrorMessage(action: string, valueName: string) {\n    return (\n        'You have tried to ' +\n        ` ${action} \"${valueName}\"` +\n        ' on a WalletModalContext without providing one.' +\n        ' Make sure to render a WalletModalProvider' +\n        ' as an ancestor of the component that uses ' +\n        'WalletModalContext'\n    );\n}\n\nexport const WalletModalContext = createContext<WalletModalContextState>(DEFAULT_CONTEXT as WalletModalContextState);\n\nexport function useWalletModal(): WalletModalContextState {\n    return useContext(WalletModalContext);\n}\n",
      "type": "registry:hook",
      "target": "hook/murphy/use-walletModal.ts"
    },
    {
      "path": "hook/murphy/use-walletModal.ts",
      "content": "import { createContext, useContext } from 'react';\n\nexport interface WalletModalContextState {\n    visible: boolean;\n    setVisible: (open: boolean) => void;\n}\n\nconst DEFAULT_CONTEXT = {\n    setVisible(_open: boolean) {\n        console.error(constructMissingProviderErrorMessage('call', 'setVisible'));\n    },\n    visible: false,\n};\nObject.defineProperty(DEFAULT_CONTEXT, 'visible', {\n    get() {\n        console.error(constructMissingProviderErrorMessage('read', 'visible'));\n        return false;\n    },\n});\n\nfunction constructMissingProviderErrorMessage(action: string, valueName: string) {\n    return (\n        'You have tried to ' +\n        ` ${action} \"${valueName}\"` +\n        ' on a WalletModalContext without providing one.' +\n        ' Make sure to render a WalletModalProvider' +\n        ' as an ancestor of the component that uses ' +\n        'WalletModalContext'\n    );\n}\n\nexport const WalletModalContext = createContext<WalletModalContextState>(DEFAULT_CONTEXT as WalletModalContextState);\n\nexport function useWalletModal(): WalletModalContextState {\n    return useContext(WalletModalContext);\n}\n",
      "type": "registry:hook",
      "target": "hook/murphy/use-walletModal.ts"
    }
  ]
}